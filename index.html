<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatehpur Hubs</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial; }
        body { background: #f5f5f5; }
        .container { max-width: 400px; margin: 0 auto; background: white; min-height: 100vh; }
        
        /* NEW STYLE FOR ADVERTISE CONTACT SECTION */
        #advertise-contact-section { margin-left: 15px; margin-right: 15px; }

        header { 
            background: linear-gradient(135deg, #1e3c72, #2a5298); 
            color: white; padding: 15px; 
            display: flex; justify-content: space-between; align-items: center;
        }
        header h1 { display: flex; align-items: center; gap: 10px; font-size: 1.4em; }
        #auth-info { font-size: 0.9em; font-weight: 600; text-align: right; max-width: 150px; }
        
        .screen { display: none; padding: 15px; }
        .screen.active { display: block; }
        
        #main-search-bar { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 25px; margin: 10px 0 20px 0; }
        
        .categories-list { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px; }
        .cat-btn { background: white; border: 2px solid #e0e0e0; padding: 12px 8px; border-radius: 10px; cursor: pointer; }
        .cat-btn.selected { background: #2a5298; color: white; border-color: #2a5298; }
        
        .profile-card { background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
        .contact-btn { background: #2a5298; color: white; border: none; padding: 8px 15px; border-radius: 20px; margin-top: 10px; cursor: pointer; }
        .whatsapp-btn { background: #25D366; color: white; border: none; padding: 8px 15px; border-radius: 20px; margin: 10px 0 0 10px; cursor: pointer; }
        
        .back-btn { background: #f8f9fa; border: 1px solid #ccc; padding: 8px 15px; border-radius: 5px; margin-bottom: 15px; cursor: pointer; }
        
        .footer { position: fixed; bottom: 0; width: 100%; max-width: 400px; background: white; padding: 10px 15px; display: flex; justify-content: space-between; border-top: 1px solid #e0e0e0; }
        .premium-btn { background: #ffd700; color: #333; padding: 8px 15px; border-radius: 20px; text-decoration: none; }
        .share-btn, .more-app-btn { background: #f8f9fa; border: 1px solid #e0e0e0; padding: 8px 15px; border-radius: 20px; cursor: pointer; }
        
        .ad-container { margin: 15px 0; text-align: center; background: #f8f9fa; padding: 10px; border-radius: 8px; border: 1px solid #e0e0e0; }
        .ad-label { font-size: 0.8em; color: #666; margin-bottom: 5px; }
        
        #promo-section { background: linear-gradient(135deg, #ff9a9e, #fad0c4); padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center; }
        #banner-area img { width: 100%; border-radius: 8px; margin-top: 10px; }
        
        h3 { color: #2a5298; margin: 15px 0 10px 0; }
    </style>
</head>
<body>
    <div class="ad-container">
        <div class="ad-label">Advertisement</div>
        <script type="text/javascript">
            atOptions = {
                'key' : '969a80a2e6bea9f00173f36024f32cb2',
                'format' : 'iframe',
                'height' : 50,
                'width' : 320,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/969a80a2e6bea9f00173f36024f32cb2/invoke.js"></script>
    </div>

    <div class="container">
        <header>
            <h1>
                <img src="https://firebasestorage.googleapis.com/v0/b/fatehpur-hubs.firebasestorage.app/o/file_0000000059806208b25eb7951e979b96.png?alt=media&token=61e97884-5882-4055-b45f-4303a0d6d818" alt="" style="height: 50px; width: auto;">
                <span>Fatehpur Hubs</span>
            </h1>
            <div id="auth-info">Fatehpur ke sabhi services ek jagah</div>
        </header>
        
        <div id="home-screen" class="screen active">
            <input type="text" id="main-search-bar" placeholder="Service Search Karein (Plumber, Electrician...)">
            
            <div class="ad-container">
                <div class="ad-label">Sponsored</div>
                <script type="text/javascript">
                    atOptions = {
                        'key' : 'd65603602583bbe6bc3308e8ee8ab792',
                        'format' : 'iframe',
                        'height' : 250,
                        'width' : 300,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/d65603602583bbe6bc3308e8ee8ab792/invoke.js"></script>
            </div>
            
            <h3>Popular Services</h3>
            <div id="mistri-categories" class="categories-list">
                <button class="cat-btn" data-cat="Plumber">üíß Plumber</button>
                <button class="cat-btn" data-cat="Electrician">‚ö° Electrician</button>
                <button class="cat-btn" data-cat="Carpenter">üî® Carpenter</button>
                <button class="cat-btn" data-cat="Mason">üß± Mason</button>
                <button class="cat-btn" data-cat="Painter">üé® Painter</button>
                <button class="cat-btn" data-cat="AC Mechanic">‚ùÑÔ∏è AC Mech.</button>
                <button class="cat-btn" data-cat="Tiler">‚óªÔ∏è Tiler</button>
                <button id="more-cat-btn" class="cat-btn" onclick="showScreen('search-screen')">More...</button>
            </div>
			<div id="mistri-categories" class="categories-list">
    </div>
<div id="service-registration" style="margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
    <h3 style="color: white; text-align: center;">‚ûï Add Your Service</h3>
    
    <form onsubmit="event.preventDefault(); registerService();">
        <input type="text" id="providerName" placeholder="Your Name" required 
               style="width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px;">
        
        <input type="tel" id="providerPhone" placeholder="Phone Number" required 
               style="width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px;">
        
        <select id="serviceCategory" required 
                style="width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px;">
            <option value="">Select Your Service</option>
            <option>Plumber</option>
            <option>Electrician</option>
            <option>Carpenter</option>
            <option>Mason</option>
            <option>Painter</option>
            <option>AC Mechanic</option>
            <option>Tiler</option>
            <option>TV Mechanic</option>
            <option>Welder</option>
            <option>Computer Repair</option>
        </select>
        
        <input type="text" id="providerArea" placeholder="Your Area in Fatehpur" required 
               style="width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px;">
        
        <input type="text" id="providerExperience" placeholder="Experience (e.g., 5 Years)" required 
               style="width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px;">
        
        <button type="submit" 
                style="width: 100%; background: #25D366; color: white; padding: 12px; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer;">
            Register Service
        </button>
    </form>
</div>

<div id="promo-section">
                <h3>‚ú® Offers aur Promotions ‚ú®</h3>
                <div id="banner-area">
                    <img src="https://via.placeholder.com/350x80?text=Your+Ad+Space+Here" alt="Promotion Ad">
                </div>
            </div>

            <div id="advertise-contact-section" style="margin: 20px 0; padding: 15px; background: #e6e6fa; border-radius: 10px; text-align: center; border: 2px solid #8a2be2;">
                <h4 style="color: #4b0082; margin-bottom: 5px; font-size: 1.1em;">
                    ‚≠ê Apne Business ko Fatehpur Hubs par Promote Karein!
                </h4>
                <p style="color: #333; font-size: 0.9em; margin-bottom: 15px;">
                    Apni dukaan, business, ya service ka Ad yahaan lagwaye aur zyada grahak paye‡•§
                </p>
                <button onclick="contactForAd('9889904191')" 
                        style="background: #8a2be2; color: white; padding: 10px 20px; border: none; border-radius: 25px; font-size: 1em; font-weight: bold; cursor: pointer;">
                    üìû Advertisement Ke Liye Sampark Kare
                </button>
            </div>
            <div id="mistri-list">
                <h3>Available Services</h3>
                <p style="text-align: center; color: #2a5298;">Loading services from Firebase...</p>
			</div> 
            
            <div style="height: 80px;"></div>
        </div>

        <div id="search-screen" class="screen">
            <button class="back-btn" onclick="showScreen('home-screen')">‚Üê Back</button>
            <h2>Sabhi Services</h2>
            
            
            <div id="all-categories-list" class="categories-list"></div> 
            <div id="mistri-list-full"></div>
        </div>

        <div class="footer">
            <a href="https://rzp.io/rzp/4kK9deS" target="_blank" class="premium-btn">‚≠ê Premium</a>
            <button class="share-btn" onclick="shareApp()">üì§ Share</button>
            <button class="more-app-btn" onclick="openMoreApps()">‚ûï More</button>
        </div>
    </div>

    <div class="ad-container">
        <div class="ad-label">Advertisement</div>
        <script type="text/javascript">
            atOptions = {
                'key' : '969a80a2e6bea9f00173f36024f32cb2',
                'format' : 'iframe',
                'height' : 50,
                'width' : 320,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/969a80a2e6bea9f00173f36024f32cb2/invoke.js"></script>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // ** ‡§Ü‡§™‡§ï‡•á ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§∏‡•á ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ Firebase ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® **
        const firebaseConfig = {
            apiKey: "AIzaSyA37JsLUIG-kypZ55vdpLTp3WKHgRH2IwY", // ‡§Ø‡§π API Key ‡§Ü‡§™‡§ï‡•á ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§•‡•Ä
            authDomain: "fatehpur-hubs.firebaseapp.com",
            databaseURL: "https://fatehpur-hubs-a3d8f-default-rtdb.asia-southeast1.firebaseio.com", // ‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ID ‡§î‡§∞ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ URL
            projectId: "fatehpur-hubs-a3a9f",
            storageBucket: "fatehpur-hubs-a3d8f.appspot.com",
            messagingSenderId: "244360674145",
            appId: "1:244360674145:web:3bc850798d5750bfabbfce"
        };

        // Firebase ‡§ï‡•ã Initialize ‡§ï‡§∞‡•á‡§Ç
        const app = firebase.initializeApp(firebaseConfig);
        const database = app.database();
        const providersRef = database.ref('service_providers'); // ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§Æ‡•á‡§Ç "service_providers" ‡§®‡•ã‡§° ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç
        
        // ‡§Ö‡§¨ ‡§°‡•á‡§ü‡§æ Firebase ‡§∏‡•á ‡§≤‡•ã‡§° ‡§π‡•ã‡§ó‡§æ, ‡§á‡§∏‡§≤‡§ø‡§è hardcoded list ‡§ï‡•ã ‡§ñ‡§æ‡§≤‡•Ä ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à
        let serviceProviders = [];

        // Function to get all providers (‡§Ö‡§¨ ‡§Ø‡§π global array ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡§∞‡•á‡§ó‡§æ)
        function getServiceProviders() {
            return serviceProviders;
        }

        // ‡§®‡§Ø‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®: Firebase ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§∏‡•Å‡§®‡§®‡§æ (Listening for data from Firebase)
        function startFirebaseListener() {
            // 'value' ‡§≤‡§ø‡§∏‡§®‡§∞ ‡§°‡•á‡§ü‡§æ ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§¨‡§¶‡§≤‡§æ‡§µ ‡§™‡§∞ ‡§ö‡§≤‡§§‡§æ ‡§π‡•à
            providersRef.on('value', (snapshot) => {
                const data = snapshot.val();
                const firebaseProviders = [];
                
                if (data) {
                    // Firebase ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã array ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç
                    for (let key in data) {
                        // Firebase key ‡§ï‡•ã provider object ‡§Æ‡•á‡§Ç ID ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)
                        let provider = data[key];
                        provider.id = key; 
                        firebaseProviders.push(provider);
                    }
                }
                
                // ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ variable ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                serviceProviders = firebaseProviders;
                
                // UI ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                loadServiceProviders('mistri-list');
                // ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§∏‡§∞‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§≠‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã, ‡§Ö‡§ó‡§∞ ‡§µ‡§π ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§π‡•ã
                if (document.getElementById('search-screen').classList.contains('active')) {
                    // ‡§Ö‡§ó‡§∞ ‡§∏‡§∞‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§™‡§∞ ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§â‡§∏‡•á ‡§∞‡•Ä-‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø filtered ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã
                    // ‡§Ø‡§π‡§æ‡§Ç ‡§π‡§Æ ‡§ï‡•ã‡§à ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ø‡§π ‡§ñ‡§æ‡§≤‡•Ä ‡§∞‡§π‡•á‡§ó‡•Ä
                }
            }, (error) => {
                console.error("Firebase Read Failed:", error);
                document.getElementById('mistri-list').innerHTML = '<p style="color:red; text-align: center;">‚ùå ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ Firebase Security Rules ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§</p>';
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            startFirebaseListener(); // Firebase ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç
            loadAllCategories();
            
            document.querySelectorAll('#mistri-categories .cat-btn').forEach(button => {
                if(button.id !== 'more-cat-btn') {
                    button.addEventListener('click', (e) => {
                        document.querySelectorAll('#mistri-categories .cat-btn').forEach(btn => btn.classList.remove('selected'));
                        e.target.classList.add('selected');
                        filterByCategory(e.target.dataset.cat, 'mistri-list');
                    });
                }
            });
            
            // ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ ‡§ï‡§æ ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞ ‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á
            document.getElementById('main-search-bar').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                const mistriListDiv = document.getElementById('mistri-list');
                mistriListDiv.innerHTML = '<h3>Search Results</h3>';
                
                const providers = getServiceProviders(); 

                const filtered = providers.filter(provider => 
                    provider.name.toLowerCase().includes(searchTerm) || provider.category.toLowerCase().includes(searchTerm)
                );
                
                if (filtered.length === 0) {
                    mistriListDiv.innerHTML += '<p style="color:red; text-align: center;">Koi service nahi mili.</p>';
                    return;
                }

                filtered.forEach(provider => {
                    const card = document.createElement('div');
                    card.className = 'profile-card';
                    card.innerHTML = `
                        <h3>${provider.name} ${provider.rating || '‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è'}</h3>
                        <p><strong>${provider.category}</strong> | ${provider.area}</p>
                        <p>Experience: ${provider.experience || 'N/A'}</p>
                        <div>
                            <button class="contact-btn" onclick="callNumber('${provider.phone}')">üìû Call Now</button>
                            <button class="whatsapp-btn" onclick="openWhatsApp('${provider.phone}')">üí¨ WhatsApp</button>
                        </div>
                    `;
                    mistriListDiv.appendChild(card);
                });
            });
        });

        // loadServiceProviders function (Firebase ‡§°‡•á‡§ü‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à)
        function loadServiceProviders(listId) {
            const mistriListDiv = document.getElementById(listId);
            if (!mistriListDiv) return;

            // Home Screen ('mistri-list') ‡§™‡§∞ header ‡§î‡§∞ data ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç
            if (listId === 'mistri-list') { 
                mistriListDiv.innerHTML = '<h3>Available Services</h3>';
                
                const providersToLoad = getServiceProviders(); // Firebase ‡§∏‡•á ‡§≤‡•ã‡§° ‡§π‡•Å‡§Ü global array

                if (providersToLoad.length === 0) {
                    mistriListDiv.innerHTML += '<p style="color:red; text-align: center;">Is list mein koi service nahi hai.</p>';
                    return;
                }

                providersToLoad.forEach(provider => {
                    const card = document.createElement('div');
                    card.className = 'profile-card';
                    
                    // HTML ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§æ‡§µ: Firebase ‡§°‡•á‡§ü‡§æ ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó
                    card.innerHTML = `
                        <h3>${provider.name} ${provider.rating || '‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è'}</h3>
                        <p><strong>${provider.category}</strong> | ${provider.area}</p>
                        <p>Experience: ${provider.experience || 'N/A'}</p>
                        <div>
                            <button class="contact-btn" onclick="callNumber('${provider.phone}')">üìû Call Now</button>
                            <button class="whatsapp-btn" onclick="openWhatsApp('${provider.phone}')">üí¨ WhatsApp</button>
                            <button class="share-btn-inline" onclick="shareProvider('${provider.name}', '${provider.category}', '${provider.phone}')">üì§ Share</button>
                        </div>
                    `;
                    mistriListDiv.appendChild(card);
                });
            }
        }


        function callNumber(phone) { window.location.href = `tel:+91${phone}`; }
        function openWhatsApp(phone) { 
            const message = "Hello, I need your service from Fatehpur Hubs app. Please contact me.";
            window.open(`https://wa.me/91${phone}?text=${encodeURIComponent(message)}`, '_blank');
        }

        function contactForAd(phone) { 
            const message = "Namaste, Main Fatehpur Hubs par advertisement ke liye sampark kar raha/rahi hoon‡•§ Kripya details bhejein‡•§";
            window.open(`https://wa.me/91${phone}?text=${encodeURIComponent(message)}`, '_blank');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
        
        const ALL_CATEGORIES = [
            { cat: 'Plumber', icon: 'üíß' }, { cat: 'Electrician', icon: '‚ö°' }, { cat: 'Carpenter', icon: 'üî®' },
            { cat: 'Mason', icon: 'üß±' }, { cat: 'Painter', icon: 'üé®' }, { cat: 'AC Mechanic', icon: '‚ùÑÔ∏è' },
            { cat: 'TV Mechanic', icon: 'üì∫' }, { cat: 'Tiler', icon: '‚óªÔ∏è' }, { cat: 'Private Teacher', icon: 'üéì' },
            { cat: 'Welder', icon: 'üî•' }, { cat: 'Computer Repair', icon: 'üíª' }
        ];

        function loadAllCategories() {
            const allCatList = document.getElementById('all-categories-list');
            if (!allCatList) return;
            allCatList.innerHTML = '';
            
            ALL_CATEGORIES.forEach(item => {
                const button = document.createElement('button');
                button.className = 'cat-btn';
                button.dataset.cat = item.cat;
                button.innerHTML = `${item.icon} ${item.cat}`;
                button.addEventListener('click', (e) => {
                    // Search Screen ‡§™‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç
                    filterByCategory(e.target.dataset.cat, 'mistri-list-full');
                });
                allCatList.appendChild(button);
            });
        }

        function filterByCategory(category, listId) {
            const mistriListDiv = document.getElementById(listId);
            if (!mistriListDiv) return;
            mistriListDiv.innerHTML = `<h3>${category} Services</h3>`;
            
            const providers = getServiceProviders(); 
            const filteredProviders = providers.filter(p => p.category === category);
            
            if (filteredProviders.length === 0) {
                mistriListDiv.innerHTML += '<p style="color:red; text-align: center;">Is category mein koi service nahi hai.</p>';
                return;
            }

            filteredProviders.forEach(provider => {
                const card = document.createElement('div');
                card.className = 'profile-card';
                card.innerHTML = `
                    <h3>${provider.name} ${provider.rating || '‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è'}</h3>
                    <p><strong>${provider.category}</strong> | ${provider.area}</p>
                    <p>Experience: ${provider.experience || 'N/A'}</p>
                    <div>
                        <button class="contact-btn" onclick="callNumber('${provider.phone}')">üìû Call Now</button>
                        <button class="whatsapp-btn" onclick="openWhatsApp('${provider.phone}')">üí¨ WhatsApp</button>
                    </div>
                `;
                mistriListDiv.appendChild(card);
            });
        }

        function shareApp() {
            const appLink = window.location.href; 
            const shareText = `‚ú® Fatehpur Hubs: Fatehpur ki sabhi services ek jagah!\n\nPlumber, Electrician, Carpenter, aur bohot kuch. Abhi app dekhein:\n${appLink}`;

            if (navigator.share) {
                navigator.share({
                    title: 'Fatehpur Hubs App',
                    text: shareText,
                    url: appLink
                });
            } else {
                window.open(`https://wa.me/?text=${encodeURIComponent(shareText)}`, '_blank');
            }
        }

        function openMoreApps() { alert("More Apps coming soon!"); } 
                
        function shareProvider(name, category, phone) {
            const message = `‚ú® Fatehpur Hubs Par ${category} Service!\n\nüë®‚Äçüîß Naam: ${name}\nüìû Phone: ${phone}\n\nFatehpur mein sabhi local services ke liye app download karein‡•§`;
            
            if (navigator.share) {
                navigator.share({
                    title: `Service Provider: ${name}`,
                    text: message,
                    url: window.location.href 
                });
            } else {
                window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
            }
        }
        
        // **** registerService FUNCTION (Saves data to Firebase) ****
        function registerService() {
            const name = document.getElementById('providerName').value;
            const phone = document.getElementById('providerPhone').value;
            const category = document.getElementById('serviceCategory').value;
            const area = document.getElementById('providerArea').value;
            const experience = document.getElementById('providerExperience').value;
            
            if (!name || !phone || !category || !area || !experience) {
                alert('‚ùå Kripya sabhi fields bharein‡•§');
                return;
            }
            
            const newProvider = {
                name: name,
                category: category,
                phone: phone,
                area: area,
                experience: experience, 
                rating: "‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è" 
            };
            
            // Firebase ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ ‡§™‡•Å‡§∂ ‡§ï‡§∞‡•á‡§Ç (Push data to Firebase)
            providersRef.push(newProvider)
                .then(() => {
                    alert('‚úÖ Service registered successfully! Ab aapki service list mein dikhegi‡•§');
                    // Form fields clear ‡§ï‡§∞‡•á‡§Ç
                    document.getElementById('providerName').value = '';
                    document.getElementById('providerPhone').value = '';
                    document.getElementById('serviceCategory').value = '';
                    document.getElementById('providerArea').value = '';
                    document.getElementById('providerExperience').value = '';
                })
                .catch((error) => {
                    console.error("Data save failed:", error);
                    alert('‚ùå Registration failed: Kripya dobara prayas karein‡•§ Iski wajah Firebase Security Rules ho sakti hai.');
                });
        }
    </script>
</body>
</html>
