<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatehpur Hubs - Local Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script type="text/javascript" src="ads.js"></script>
    <style>
        body {font-family: 'Inter', sans-serif;background-color:#f0f4f8;color:#333;margin:0;padding:0;display:flex;justify-content:center;align-items:center;min-height:100vh;}
        #app-container {width:100%;max-width:420px;background:#fff;box-shadow:0 0 20px rgba(0,0,0,0.1);border-radius:12px;overflow:hidden;display:flex;flex-direction:column;min-height:100vh;}
        #app-header {background:#2a5298;color:white;padding:15px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 4px rgba(0,0,0,0.1);position:sticky;top:0;z-index:10;}
        .logo {font-size:1.5rem;font-weight:bold;}
        .logout-btn {background:#ff4d4f;color:white;padding:5px 10px;border-radius:8px;font-size:0.8rem;font-weight:600;border:none;cursor:pointer;}
        #nav-bar {display:flex;justify-content:space-around;background:#fff;border-top:1px solid #eee;position:fixed;bottom:0;width:100%;max-width:420px;box-shadow:0 -2px 5px rgba(0,0,0,0.05);z-index:10;}
        .nav-item {flex-grow:1;text-align:center;padding:10px 0;cursor:pointer;color:#777;font-size:0.75rem;transition:color .2s;}
        .nav-item.active {color:#2a5298;}
        .nav-item i {display:block;font-size:1.2rem;margin-bottom:3px;}
        #mainApp {flex-grow:1;overflow-y:auto;padding-bottom:80px;}
        .screen {display:none;padding:15px;min-height:100%;}
        .screen.active {display:block;}
        /* Baaki saare styles bilkul same */
        #registrationScreen {display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px;text-align:center;height:100vh;}
        #registrationScreen h2 {color:#2a5298;margin-bottom:20px;}
        .input-group, #otpSection {width:100%;margin-bottom:15px;}
        input[type="text"], input[type="number"] {width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box;font-size:1rem;}
        .main-btn {background:#2a5298;color:white;padding:12px 20px;border:none;border-radius:8px;cursor:pointer;font-size:1.1rem;width:100%;margin-top:10px;}
        /* Baaki sab styles same */
    </style>
</head>
<body>
    <div id="app-container">
        <!-- LOGOUT AND AUTH SCREEN -->
        <div id="registrationScreen" style="display:none;">
            <h2>Fatehpur Hubs: Services & Jobs</h2>
            <div id="loginMsg">कृपया लॉगिन करें</div>

            <div id="profileInputSection" class="input-group">
                <input type="text" id="userName" placeholder="आपका नाम (Name)" required>
                <input type="text" id="userArea" placeholder="आपका एरिया/मोहल्ला (Area)" required style="margin-top:10px;">
                <input type="number" id="phoneInput" placeholder="10 अंक का फ़ोन नंबर" maxlength="10" required style="margin-top:10px;">
                <button id="sendOtpBtn" class="main-btn">Send OTP & Sign Up</button>
            </div>

            <div id="otpSection" class="input-group" style="display:none;">
                <input type="number" id="otpInput" placeholder="6 अंक का OTP" maxlength="6" required>
                <button id="verifyOtpBtn" class="main-btn">Verify OTP & Login</button>
            </div>
            
            <p style="font-size:0.8rem;color:#777;margin-top:20px;">Firebase Phone Authentication द्वारा सुरक्षित।</p>
            <div id="recaptcha-container"></div>
        </div>

        <!-- MAIN APP UI -->
        <div id="mainApp" style="display:none;">
            <header id="app-header">
                <div class="logo">Fatehpur Hubs</div>
                <button class="logout-btn" onclick="window.logOut()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </header>

            <div id="mainAppContent">
                <!-- 1. HOME SCREEN -->
                <div id="home-screen" class="screen active">
                    <div class="ad-container">
                        <script type="text/javascript">
                            atOptions = { 'key' : '969a80a2e6bea9f00173f36024f32cb2', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
                            document.write('<script type="text/javascript" src="//www.highperformanceformat.com/969a80a2e6bea9f00173f36024f32cb2/invoke.js"><\/script>');
                        </script>
                    </div>

                    <div id="search-container">
                        <input type="text" id="main-search-bar" placeholder="सेवा या एरिया के अनुसार खोजें..." onkeyup="searchServices()">
                    </div>

                    <div id="mistri-categories"></div>
                    <div id="mistri-list"></div>

                    <div class="ad-container" style="width:300px;height:250px;margin:20px auto;border:1px solid #ddd;text-align:center;">
                        <script type="text/javascript">
                            atOptions = {'key' : 'd65603602583bbe6bc3308e8ee8ab792','format' : 'iframe','height' : 250,'width' : 300,'params' : {}};
                        </script>
                        <script type="text/javascript" src="//www.highperformanceformat.com/d65603602583bbe6bc3308e8ee8ab792/invoke.js"></script>
                    </div>

                    <button id="load-more-providers" class="main-btn" style="display:none;margin:15px auto;" onclick="loadCategories(true)">
                        Load More Services
                    </button>
                </div>

                <!-- बाकी स्क्रीन्स (add-service-screen, jobs-screen, share-screen) यहाँ same रहेंगी -->
                <!-- मैं यहाँ नहीं लिख रहा ताकि message छोटा रहे, तुम्हारे पास पहले से हैं -->

                <!-- 2. ADD SERVICE SCREEN --> 
                <div id="add-service-screen" class="screen">
                    <!-- तुम्हारा पुराना कोड यहाँ paste कर देना -->
                </div>

                <!-- 3. JOBS SCREEN -->
                <div id="jobs-screen" class="screen">
                    <!-- तुम्हारा पुराना कोड यहाँ paste कर देना -->
                </div>

                <!-- 4. SHARE SCREEN -->
                <div id="share-screen" class="screen">
                    <!-- तुम्हारा पुराना कोड यहाँ paste कर देना -->
                </div>

            </div> <!-- mainAppContent end -->

            <!-- YEH HAI NAYA STICKY BOTTOM AD (सभी स्क्रीन पर दिखेगा) -->
            <div id="global-sticky-bottom-ad" style="
                position:fixed; bottom:56px; left:50%; transform:translateX(-50%);
                width:320px; height:50px; background:white; border-radius:12px;
                box-shadow:0 -4px 15px rgba(0,0,0,0.12); overflow:hidden;
                z-index:8; padding:4px; display:none;">
                <div style="width:100%;height:100%;border-radius:8px;overflow:hidden;">
                    <script type="text/javascript">
                        atOptions = {
                            'key' : '969a80a2e6bea9f00173f36024f32cb2',
                            'format' : 'iframe',
                            'height' : 50,
                            'width' : 320,
                            'params' : {}
                        };
                        document.write('<script type="text/javascript" src="//www.highperformanceformat.com/969a80a2e6bea9f00173f36024f32cb2/invoke.js"><\/script>');
                    </script>
                </div>
            </div>

            <!-- NAV BAR (footer patti) -->
            <div id="nav-bar">
                <div class="nav-item active" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i> होम
                </div>
                <div class="nav-item" onclick="showScreen('add-service-screen')">
                    <i class="fas fa-tools"></i> सर्विस जोड़ें
                </div>
                <div class="nav-item" onclick="showScreen('jobs-screen')">
                    <i class="fas fa-briefcase"></i> नौकरियाँ
                </div>
                <div class="nav-item" onclick="showScreen('share-screen')">
                    <i class="fas fa-share-alt"></i> शेयर
                </div>
            </div>

        </div> <!-- mainApp end -->
    </div> <!-- app-container end -->
    <script>
    const firebaseConfig = { /* तुम्हारा पुराना config same */ 
        apiKey: "AIzaSyA37JsLUIG-kypZ55vdpLTp3WKHgRH2IwY",
        authDomain: "fatehpur-hubs-a3a9f.firebaseapp.com",
        databaseURL: "https://fatehpur-hubs-a3a9f-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "fatehpur-hubs-a3a9f",
        storageBucket: "fatehpur-hubs-a3a9f.appspot.com",
        messagingSenderId: "294360741451",
        appId: "1:294360741451:web:3bc85078805750b9fabfce"
    };

    // तुम्हारा पूरा पुराना सारा JavaScript code यहीं आएगा (बिल्कुल वैसा का वैसा)

    // बस नीचे ये 4 लाइन्स जोड़ दो (बिल्कुल अंत में, window.onload के अंदर या बाहर भी चलेगा)

    window.onload = () => {
        firebase.initializeApp(firebaseConfig);
        window.database = firebase.database();
        window.providersRef = database.ref('service_providers');
        window.jobsRef = database.ref('local_jobs');

        // तुम्हारा पुराना सारा code यहाँ रहेगा...

        // NAYI 4 LINES – Bottom Ad दिखाने के लिए
        setTimeout(() => {
            const ad = document.getElementById('global-sticky-bottom-ad');
            if (ad) ad.style.display = 'block';
        }, 3000); // 3 सेकंड बाद दिखेगा, ad load हो जाएगा

        // बाकी सब same
    };
    </script>

    <script type="text/javascript" src="ads.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js');
            });
        }
    </script>
</body>
</html>
